!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("axios"),require("pd-sputil")):"function"==typeof define&&define.amd?define(["axios","pd-sputil"],t):"object"==typeof exports?exports.pdspserverajax=t(require("axios"),require("pd-sputil")):e.pdspserverajax=t(e.axios,e.pdsputil)}(this,function(e,t){return function(e){function t(a){if(r[a])return r[a].exports;var n=r[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,a){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,r){"use strict";function a(e){return e.endPoint="_api/contextinfo",A(e),y({method:"POST",headers:{Accept:"application/json; odata=minimalmetadata"},url:e.configuredUrl}).then(function(t){return e.endPoint=null,e.configuredUrl=null,t})}function n(e){return y({method:"GET",headers:{Accept:"application/json; odata=minimalmetadata"},url:e})}function i(e){return e.listGUID||e.listTitle?(q(e),n(e.listUrl).then(function(t){var r=e.allResults||[],a=t.data;return e.allResults=r.concat(a.value),a["odata.nextLink"]?(e.listUrl=a["odata.nextLink"],i(e)):e.allResults})):Promise.reject("must pass listGUID or listTitle to ajaxGetAllListResults")}function o(e){var t=[],r=0;for(e.totalItems=e.getUrls.length,e.totalPerTrip=50,e.allResults=[],e.numberToStartAt=0;e.numberToStartAt<e.totalItems;e.numberToStartAt++){var a=e.getUrls[e.numberToStartAt];if(t.push(a),++r===e.totalPerTrip){e.numberToStartAt++;break}}return M({origin:e.origin,url:e.url},t).then(function(t){return e.allResults=e.allResults.concat(t),e.numberToStartAt<e.totalItems?o(e):e.allResults})}function s(e){var t=null;if(!e.profileEmails||0===e.profileEmails.length)throw new Error("profile emails must be provided when calling the batch profile function");e.origin=Object(x.getURLOrigin)(),t=[];var r=e.origin+e.url;return e.profileEmails.forEach(function(e){var a=Object(x.encodeAccountName)(e);t.push(r+"/_api/sp.userprofiles.peoplemanager/GetPropertiesFor('"+a+"')?$select=UserProfileProperties")}),o({origin:e.origin,url:e.url,getUrls:t})}function l(e){return O(e),n(e.listUrl)}function u(e){var t=e.currentResults||[],r={startrow:0,rowlimit:500,TrimDuplicates:!1,selectproperties:"'"+e.properties.join(",")+"'"};return r.startrow=e.startrow?e.startrow:0,r.sourceId=e.sourceId?"'"+e.sourceId+"'":"'b09a7990-05ea-4af9-81ef-edfab16c4e31'",e.endPoint="_api/search/query",r.querytext="'"+e.query+"'",A(e),y({url:e.configuredUrl,method:"GET",headers:{Accept:"application/json; odata=minimalmetadata"},params:r}).then(function(a){var n=a.data.PrimaryQueryResult.RelevantResults;return t=t.concat(n.Table.Rows),e.currentResults=t,n.TotalRows>r.startrow+n.RowCount?(e.startrow=r.startrow+n.RowCount,u(e)):e.currentResults})}function c(e){return a(e).then(function(t){return e.endPoint="_api/web",A(e),e.configuredUrl+="/ensureUser('"+Object(x.encodeAccountName)(e.email)+"')",y({url:e.configuredUrl,method:"POST",contentType:D,headers:{Accept:T,"X-RequestDigest":t.data.FormDigestValue}})})}function d(e){return e.endPoint="_api/web/siteusers",A(e),e.configuredUrl+="?$filter=LoginName eq '"+Object(x.encodeAccountName)(e.email)+"'",n(e.configuredUrl)}function p(e){return a(e).then(function(t){var r={query:{__metadata:{type:"SP.CamlQuery"},ViewXml:e.caml}},a={Accept:"application/json; odata=minimalmetadata","Content-Type":"application/json; odata=verbose","X-RequestDigest":t.data.FormDigestValue};return O(e),e.listUrl+="/getitems",y({url:e.listUrl,method:"POST",data:JSON.stringify(r),headers:a})})}function f(e){var t=Object(x.encodeAccountName)(e.email);return e.endPoint="_api/web",A(e),e.permsLink=e.configuredUrl+"/getusereffectivepermissions(@user)?@user='"+t+"'",C(e)}function m(e){var t=Object(x.encodeAccountName)(e.email);return O(e),e.permsLink=e.listUrl+"/getusereffectivepermissions(@user)?@user='"+t+"'",C(e)}function h(e){return e.endPoint="/_api/web",A(e),e.configuredUrl+="/GetUserbyId("+e.userId+")/Groups",n(e.configuredUrl).then(function(e){var t=[];return e.data.value.forEach(function(e){t.push(e.Title)}),t})}function g(e){return _(e)}function P(e){return e.headerData={"X-HTTP-Method":"MERGE","If-Match":e.etag||"*"},_(e)}function U(e){return e.headerData={"X-HTTP-Method":"DELETE","If-Match":e.etag||"*"},E(e)}function b(e){return e.urlModifier="/recycle",E(e)}function j(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=null;return e.email?(e.endPoint="_api/sp.userprofiles.peoplemanager",t="/getpropertiesfor(@v)?@v='"+Object(x.encodeAccountName)(e.email)+"'&"):(e.endPoint="_api/SP.UserProfiles.PeopleManager/GetMyProperties",t="?"),A(e),e.configuredUrl+=t+"$select=UserProfileProperties",n(e.configuredUrl).then(function(e){return!0===e.data["odata.null"]?[]:e.data.UserProfileProperties})}function v(e){return e.allData||(e.allData=!1),O(e),e.listUrl+="/fields?$filter=Hidden eq "+e.allData+" and ReadOnlyField eq "+e.allData,n(e.listUrl)}Object.defineProperty(t,"__esModule",{value:!0}),t.ajaxGetContext=a,t.ajaxGetData=n,t.ajaxGetAllListResults=i,t.ajaxGetBatchMetered=o,t.ajaxGetBatchProfiles=s,t.ajaxGetListInfo=l,t.ajaxPeopleSearch=u,t.ajaxEnsureUser=c,t.ajaxGetSiteUserInfoByEmail=d,t.ajaxGetItemsByCaml=p,t.ajaxGetUserSitePermissions=f,t.ajaxGetUserListPermissions=m,t.ajaxGetCurrentUserGroups=h,t.ajaxCreateItem=g,t.ajaxUpdateItem=P,t.ajaxDeleteItem=U,t.ajaxRecycleItem=b,t.userProfileData=j,t.getListColumns=v;var y=r(1),x=(r.n(y),r(2)),T=(r.n(x),"application/json;odata=minimalmetadata"),D="application/json;odata=verbose",w=function(e){return"SP.Data."+e.charAt(0).toUpperCase()+e.slice(1)+"ListItem"},I=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],R=function(){for(var e="",t=0;t<32;t++){var r=Math.floor(16*Math.random());switch(t){case 8:e+="-";break;case 12:r=4,e+="-";break;case 16:r=3&r|8,e+="-";break;case 20:e+="-"}e+=I[r]}return e},A=function(e){return e.configuredUrl=e.origin?e.origin:Object(x.getURLOrigin)(),e.url&&(e.configuredUrl+=e.url),e.endPoint&&(e.configuredUrl+="/"+e.endPoint),e},O=function(e){if(e.url&&!e.listUrl)return e.endPoint="_api/web",A(e),e.listGUID?e.listUrl=e.configuredUrl+="/lists(guid'"+e.listGUID+"')":e.listTitle&&(e.listUrl=e.configuredUrl+="/lists/getbytitle('"+e.listTitle+"')"),e},S=function(e){var t=e.itemId||"";if(!e.listItemUrl)return O(e),e.listItemUrl=e.listUrl+="/items("+t+")",e},G=function(e){var t;return e.listName?(t=w(e.listName),Promise.resolve(t)):l(e).then(function(e){return e.data.ListItemEntityTypeFullName})},_=function(e){return e.headerData||(e.headerData={}),G(e).then(function(t){return e.item=Object.assign({__metadata:{type:t}},e.infoToServer),a(e)}).then(function(t){return e.headerData["X-RequestDigest"]=t.data.FormDigestValue,e.headerData.Accept="application/json; odata=minimalmetadata",e.headerData["Content-Type"]=D,S(e),y({url:e.listItemUrl,method:"POST",data:JSON.stringify(e.item),headers:e.headerData})})},E=function(e){return e.headerData||(e.headerData={}),a(e).then(function(t){return e.headerData["X-RequestDigest"]=t.data.FormDigestValue,e.headerData.Accept="application/json; odata=minimalmetadata",e.headerData["Content-Type"]=D,S(e),e.urlModifier&&(e.listItemUrl+=e.urlModifier),y({url:e.listItemUrl,method:"POST",headers:e.headerData})})},L=function(e){var t=new SP.BasePermissions;t.initPropertiesFromJson(e);var r=[];for(var a in SP.PermissionKind.prototype)if(SP.PermissionKind.hasOwnProperty(a)){var n=SP.PermissionKind.parse(a);t.has(n)&&r.push(a)}return r},q=function(e){e.listUrl||(e.endPoint||(e.endPoint="_api/web"),O(e),e.listUrl+="/items?",e.select&&(e.listUrl+="$select="+e.select+"&"),e.top&&(e.listUrl+="$top="+e.top+"&"),e.expand&&(e.listUrl+="$expand="+e.expand+"&"),e.filter&&(e.listUrl+="$filter="+e.filter+"&"),e.orderBy&&(e.listUrl+="$orderby="+e.orderBy+"&"),/\$$/.test(e.listUrl)&&e.listUrl.slice(0,-1))},C=function(e){return n(e.permsLink).then(function(e){return L(e.data)})};!function(){if(!Promise||!Object.assign)throw new Error("Promise API is not available. Please add a polyfill as a dependency to continue.");if(!y)throw new Error("axios API is not available. Please add a axios as a dependency to continue.");if(!x.encodeAccountName||!x.getURLOrigin)throw new Error("pd-sputil API is not available. Please add a pd-sputil as a dependency to continue.")}();var M=function(e,t){var r,n,i=R(),o=[];return t.forEach(function(e){o.push("--batch_"+i),o.push("Content-Type: application/http"),o.push("Content-Transfer-Encoding: binary"),o.push(""),o.push("GET "+e+" HTTP/1.1"),o.push("Accept: "+T),o.push("")}),o.push("--batch_"+i+"--"),r=o.join("\r\n"),a(e).then(function(t){return e.endPoint="_api/$batch",A(e),n={"X-RequestDigest":t.data.FormDigestValue,"Content-Type":'multipart/mixed; boundary="batch_'+i+'"'},y({url:e.configuredUrl,method:"POST",data:r,headers:n}).then(function(e){for(var t=[],r=e.data.split("\n"),a=0;a<r.length;a++)if("{"===r[a].charAt(0))try{var n=JSON.parse(r[a]);t.push(n)}catch(e){}return t})})}},function(t,r){t.exports=e},function(e,r){e.exports=t}])});