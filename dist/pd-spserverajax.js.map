{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap b857b61b895d026e8909","webpack:///external {\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\",\"amd\":\"jquery\",\"root\":\"$\"}","webpack:///external {\"commonjs\":\"pd-sputil\",\"commonjs2\":\"pd-sputil\",\"amd\":\"pd-sputi\",\"root\":\"pdspBase\"}","webpack:///./src/library.js"],"names":["ajaxGetContext","ajaxGetData","ajaxGetAllResults","ajaxGetBatch","ajaxGetListInfo","ajaxPeopleSearch","ajaxEnsureUser","ajaxGetSiteUserInfoByKey","ajaxGetItemsByCaml","ajaxGetUserPermissions","ajaxGetCurrentUserGroups","ajaxCreateItem","ajaxUpdateItem","ajaxDeleteItem","ajaxRecycleItem","userProfileData","getListColumns","$","spUtil","profilePropsCleaner","props","propertiesObj","forEach","item","profileProps","indexOf","Key","DisplayName","Value","JobTitle","Department","Location","createProfileUrl","origin","email","url","formattedUserName","encodeAccountName","createlistitemtype","listName","charAt","toUpperCase","slice","guidHexCodes","createGUID","result","index","value","Math","floor","random","checkUrlOrigin","addOn","Error","configuredUrl","listUrlConfigure","listUrl","listGUID","listTitle","listItemUrlConfigure","itemId","listItemUrl","getEntityType","entityData","Deferred","resolve","then","data","ListItemEntityTypeFullName","nonDeleteProcess","headerData","header","type","extend","infoToServer","context","FormDigestValue","Accept","ajax","contentType","JSON","stringify","headers","deleteProcess","urlModifier","parseBasePermissions","permissions","SP","BasePermissions","initPropertiesFromJson","permLevels","permLevelName","PermissionKind","prototype","hasOwnProperty","permLevel","parse","has","push","method","allResults","response","ArrayOfUrls","batchGUID","digestValue","batchBody","batchHeader","goingToUrl","batchContents","document","getElementById","getPageInfo","webAbsoluteUrl","join","parsedArray","responseToArray","split","currentLine","length","tryParseJson","e","requestQuery","currentResults","serverQueryData","sourceid","startrow","rowlimit","TrimDuplicates","selectproperties","profileProperties","querytext","empData","relevantResults","PrimaryQueryResult","RelevantResults","concat","Table","Rows","TotalRows","RowCount","acctName","siteURL","site","endpointUrl","encodeURIComponent","key","encodedKey","properties","query","caml","headerdata","toLowerCase","toSend","encodedEmail","userEmail","userId","groups","groupArray","Title","etag","UserProfileProperties","siteUrl","listId","includeAll","includeOthers"],"mappings":"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","file":"pd-spserverajax.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"jquery\"), require(\"pd-sputil\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"jquery\", \"pd-sputi\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"pdspserverajax\"] = factory(require(\"jquery\"), require(\"pd-sputil\"));\n\telse\n\t\troot[\"pdspserverajax\"] = factory(root[\"$\"], root[\"pdspBase\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_1__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b857b61b895d026e8909","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\",\"amd\":\"jquery\",\"root\":\"$\"}\n// module id = 0\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"pd-sputil\",\"commonjs2\":\"pd-sputil\",\"amd\":\"pd-sputi\",\"root\":\"pdspBase\"}\n// module id = 1\n// module chunks = 0","/**\r\n    app name spajax\r\n */\r\n\r\n/**\r\n    app name pd-spservercontacts\r\n */\r\nimport * as $ from \"jquery\";\r\nimport * as spUtil from \"pd-sputil\";\r\n\r\nconst profilePropsCleaner = function (props) {\r\n    var propertiesObj = {};\r\n\r\n    props.forEach(function(item) {\r\n\r\n        if ( spUtil.profileProps.indexOf(item.Key) === -1 ) {\r\n            return;\r\n        }\r\n        if ( item.Key === \"PreferredName\" ) {\r\n            propertiesObj.DisplayName = item.Value || 'None';\r\n        }\r\n        if ( item.Key === \"SPS-JobTitle\" ) {\r\n            propertiesObj.JobTitle = item.Value || 'None';\r\n        }\r\n        if ( item.Key === \"SPS-Department\" ) {\r\n            propertiesObj.Department = item.Value || 'None';\r\n        }\r\n        if ( item.Key === \"SPS-Location\" ) {\r\n            propertiesObj.Location = item.Value || 'None';\r\n        }\r\n\r\n        propertiesObj[item.Key] = item.Value || 'None';\r\n\r\n    });\r\n    \r\n    return propertiesObj;\r\n};\r\nconst createProfileUrl = function(origin, email) {\r\n    let url;\r\n\r\n    if(email) {\r\n        let formattedUserName = spUtil.encodeAccountName(email);\r\n\r\n        url += `${origin}/_api/sp.userprofiles.peoplemanager`;\r\n        url += `/getpropertiesfor(@v)?@v='${formattedUserName}'`;\r\n        url += '&$select=UserProfileProperties';\r\n    } else {\r\n        //url for get current user\r\n        url += `${origin}/_api/SP.UserProfiles.PeopleManager/GetMyProperties?`;\r\n        url += '&$select=UserProfileProperties';\r\n    }\r\n    return url;\r\n};\r\nconst createlistitemtype = function(listName) {\r\n    return 'SP.Data.' + \r\n        listName.charAt(0).toUpperCase() + \r\n        listName.slice(1) + \r\n        'ListItem';\r\n};\r\nconst guidHexCodes = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'];\r\nconst createGUID = function() {\r\n    var result = '';\r\n\r\n    for (var index = 0; index < 32; index++) {\r\n        var value = Math.floor(Math.random() * 16);\r\n\r\n        switch (index) {\r\n        case 8:\r\n            result += '-';\r\n            break;\r\n        case 12:\r\n            value = 4;\r\n            result += '-';\r\n            break;\r\n        case 16:\r\n            value = value & 3 | 8;\r\n            result += '-';\r\n            break;\r\n        case 20:\r\n            result += '-';\r\n            break;\r\n        }\r\n        result += guidHexCodes[value];\r\n    }\r\n    return result;\r\n};\r\nconst checkUrlOrigin = function(props, addOn) {\r\n\r\n    if (!props.origin) {\r\n        throw new Error('origin must be provided to ajax function, ex http://something.sharepoint.com');\r\n    }\r\n    props.configuredUrl = props.origin + props.url;\r\n\r\n    if(addOn) {\r\n        props.configuredUrl += addOn;\r\n    }\r\n    return props;\r\n\r\n    //fell through so the incorrect datatype was passed to function, error\r\n};\r\nconst listUrlConfigure = function(props) {\r\n\r\n    if (!props.url || props.listUrl) {\r\n        return;\r\n    }\r\n\r\n    checkUrlOrigin(props, \"/_api/web\");\r\n\r\n    if (props.listGUID) {\r\n        props.listUrl = props.configuredUrl += \"/lists(guid'\"+ props.listGUID +\"')\";\r\n    } else if (props.listTitle) {\r\n        props.listUrl = props.configuredUrl += \"/lists/getbytitle('\"+ props.listTitle +\"')\";\r\n    }\r\n    return props;\r\n};\r\nconst listItemUrlConfigure = function(props) {\r\n    //for create, update, delete\r\n    var item = props.itemId || '';\r\n\r\n    if (props.listItemUrl) {\r\n        return;\r\n    }\r\n\r\n    listUrlConfigure(props);\r\n\r\n    props.listItemUrl = props.listUrl += \"/items(\"+ item +\")\";\r\n    return props;\r\n};\r\nconst getEntityType = function(props) {\r\n\r\n    var entityData;\r\n\r\n    if (props.listName) {\r\n        entityData = createlistitemtype(props.listName);\r\n        return $.Deferred().resolve(entityData);\r\n    }\r\n\r\n    return ajaxGetListInfo(props)\r\n    .then(function(data) {\r\n        return data.ListItemEntityTypeFullName;\r\n    });\r\n};\r\nconst nonDeleteProcess = function(props, headerData) {\r\n\r\n    var item,\r\n        header = headerData || {};\r\n\r\n    return getEntityType(props)\r\n    .then(function(type) {\r\n        item = $.extend({\r\n            '__metadata': {'type': type}\r\n        }, props.infoToServer);\r\n\r\n        return ajaxGetContext(props.url);\r\n    }).then(function(context) {\r\n\r\n        header['X-RequestDigest'] = context.FormDigestValue;\r\n        header.Accept = 'application/json; odata=minimalmetadata';\r\n\r\n        listItemUrlConfigure(props);\r\n\r\n        return $.ajax({\r\n            url: props.listItemUrl,\r\n            type: 'POST',\r\n            contentType: 'application/json;odata=verbose',\r\n            data: JSON.stringify(item),\r\n            headers: header\r\n        });\r\n    });\r\n};\r\nconst deleteProcess = function(props, headerData, urlModifier) {\r\n\r\n    var header = headerData || {};\r\n\r\n    return ajaxGetContext(props.url)\r\n    .then(function(context) {\r\n\r\n        header['X-RequestDigest'] = context.FormDigestValue;\r\n        header.Accept = 'application/json; odata=minimalmetadata';\r\n\r\n        listItemUrlConfigure(props);\r\n\r\n        if (urlModifier) {\r\n            props.listItemUrl += urlModifier;\r\n        }\r\n\r\n        return $.ajax({\r\n            url: props.listItemUrl,\r\n            type: 'POST',\r\n            contentType: 'application/json;odata=verbose',\r\n            headers: header\r\n        });\r\n    });\r\n};\r\nconst parseBasePermissions = function(value) {\r\n    var permissions = new SP.BasePermissions();\r\n    permissions.initPropertiesFromJson(value);\r\n    var permLevels = [];\r\n    for(var permLevelName in SP.PermissionKind.prototype) {\r\n        if (SP.PermissionKind.hasOwnProperty(permLevelName)) {\r\n            var permLevel = SP.PermissionKind.parse(permLevelName);\r\n            if(permissions.has(permLevel)){\r\n                    permLevels.push(permLevelName);\r\n            }\r\n        }     \r\n    }\r\n    return permLevels;   \r\n};\r\n\r\nexport function ajaxGetContext(url) {\r\n    //response.FormDigestValue\r\n    var props = {url: url};\r\n    \r\n    checkUrlOrigin(props, \"/_api/contextinfo\");\r\n\r\n    return $.ajax({\r\n        url: props.configuredUrl,\r\n        method: \"POST\",\r\n        headers: { \"Accept\": \"application/json; odata=minimalmetadata\" }\r\n    });\r\n}\r\nexport function ajaxGetData(url) {\r\n    return $.ajax({\r\n        url: url,\r\n        type: 'GET',\r\n        headers: {'Accept': 'application/json; odata=minimalmetadata'}\r\n    });\r\n}\r\nexport function ajaxGetAllResults(url, allResults) {\r\n\r\n    return ajaxGetData(url)\r\n    .then(function(response) {\r\n        var url,\r\n            data = allResults || [];\r\n        \r\n        response.value.forEach(function(item) {\r\n            data.push(item);\r\n        });\r\n        if (response['odata.nextLink']) {\r\n            url = response['odata.nextLink'];\r\n            return ajaxGetAllResults(url, data);\r\n        }\r\n        return data;\r\n    });\r\n}\r\nexport function ajaxGetBatch(ArrayOfUrls, props) {\r\n    // props = {\r\n    // \turl: ,\r\n    // \tcontext:\r\n    // }\r\n    var batchGUID = createGUID(),\r\n        digestValue,\r\n        batchBody,\r\n        batchHeader,\r\n        goingToUrl,\r\n        batchContents = [];\r\n\r\n    //get context\r\n    if(props && props.context) {\r\n        digestValue = props.context;\r\n    } else {\r\n        digestValue = document.getElementById('__REQUESTDIGEST').value;\r\n    }\r\n\r\n    //getUrl\r\n    if(props && props.url) {\r\n        //must be the whole url, \"https://something.sharepoint.com/sites/spdev\"\r\n        goingToUrl = props.url;\r\n    } else {\r\n        goingToUrl = spUtil.getPageInfo().webAbsoluteUrl;\r\n    }\r\n\r\n    batchHeader = {\r\n    'X-RequestDigest': digestValue,\r\n    'Content-Type': 'multipart/mixed; boundary=\"batch_' + batchGUID + '\"'\r\n    };\r\n\r\n    //batch (operation)\r\n    ArrayOfUrls.forEach(function(item) {\r\n        batchContents.push('--batch_' + batchGUID);\r\n        batchContents.push('Content-Type: application/http');\r\n        batchContents.push('Content-Transfer-Encoding: binary');\r\n        batchContents.push('');\r\n        batchContents.push('GET ' + item + ' HTTP/1.1');\r\n        batchContents.push('Accept: application/json;odata=minimalmetadata');\r\n        batchContents.push('');\r\n    });\r\n\r\n    batchContents.push('--batch_' + batchGUID + '--');\r\n\r\n    batchBody = batchContents.join('\\r\\n');\r\n\r\n    return $.ajax({\r\n        url: goingToUrl + '/_api/$batch',\r\n        type: 'POST',\r\n        data: batchBody,\r\n        headers: batchHeader\r\n    }).then(function(response) {\r\n        var parsedArray = [],\r\n            responseToArray = response.split('\\n');\r\n\r\n        for (var currentLine = 0; currentLine < responseToArray.length; currentLine++) {\r\n            if (responseToArray[currentLine].charAt(0) === '{') {\r\n            try {\r\n                // parse the JSON response...\r\n                var tryParseJson = JSON.parse(responseToArray[currentLine]);\r\n\r\n                parsedArray.push(tryParseJson);\r\n\r\n            } catch (e) {\r\n                // don't do anything... just keep moving\r\n            }\r\n            }\r\n        }\r\n\r\n        return parsedArray;\r\n\r\n    });\r\n}\r\nexport function ajaxGetListInfo(props) {\r\n    //if you are pulling for rest create you need property - EntityTypeName\r\n    //will accept listGUID or listTitle\r\n    // {\r\n    // \turl: '',\r\n    // \tlistGUID: 'dfdf-dfdfdaqfe-asdfasdf-ewf'\r\n    // }\r\n    listUrlConfigure(props);\r\n    return ajaxGetData(props.listUrl);\r\n}\r\nexport function ajaxPeopleSearch(origin, requestQuery, currentResults ) {\r\n    //returns employees only\r\n    //origin should be absoult url 'https://something.sharepoint.com/_api/search/query'\r\n    var allResults = currentResults || [],\r\n        serverQueryData = {\r\n            sourceid: \"'213c743c-4c9b-4433-ad8c-6d4c9cd4d769'\",\r\n            startrow: 0,\r\n            rowlimit: 500,\r\n            TrimDuplicates: false,\r\n            selectproperties: \"'\" + spUtil.profileProperties.join(',') + \"'\"\r\n        };\r\n    \r\n        if ( typeof requestQuery === 'string' ) {\r\n            serverQueryData.querytext = \"'\" + requestQuery + \"'\";\r\n        } else{\r\n            //querytext: \"'\" + 'Bureau=\"'+ division + '\"\\''\r\n            serverQueryData = $.extend({}, serverQueryData, requestQuery);\r\n        }\r\n\r\n    return $.ajax({\r\n        url: origin,\r\n        type: 'GET',\r\n        headers: {'Accept': 'application/json; odata=minimalmetadata'},\r\n        data: serverQueryData\r\n    }).then(function(empData) { //success function\r\n\r\n        var relevantResults = empData.PrimaryQueryResult.RelevantResults;\r\n\r\n        allResults = allResults.concat(relevantResults.Table.Rows);\r\n\r\n        if (relevantResults.TotalRows > (serverQueryData.startrow + relevantResults.RowCount)) {\r\n            serverQueryData.startrow = serverQueryData.startrow + relevantResults.RowCount;\r\n            return ajaxPeopleSearch(origin, serverQueryData, allResults);\r\n        } else {\r\n            return allResults;\r\n        }\r\n    });\r\n}\r\nexport function ajaxEnsureUser(acctName, siteURL, context) {\r\n    //acctName should be i:0#.f|membership|user@domain.onmicrosoft.com link this\r\n    var site = siteURL || spUtil.getPageInfo().webAbsoluteUrl,\r\n        endpointUrl = site + \"/_api/web/ensureUser('\" + encodeURIComponent(acctName) + \"')\";\r\n    return $.ajax({       \r\n        url: endpointUrl,   \r\n        type: \"POST\",  \r\n        contentType: \"application/json;odata=verbose\",\r\n        headers: { \r\n            \"Accept\": \"application/json;odata=minimalmetadata\",\r\n            \"X-RequestDigest\": context || document.getElementById('__REQUESTDIGEST').value\r\n        }\r\n    });\r\n}\r\nexport function ajaxGetSiteUserInfoByKey(key) {\r\n    //key is i:0#.f|membership|user@domain.onmicrosoft.com\r\n    var encodedKey = encodeURIComponent(key),\r\n        url = spUtil.getPageInfo().webAbsoluteUrl + \"/_api/web/siteusers?\"+\r\n        \"$filter=LoginName eq '\"+ encodedKey +\"'\";\r\n    return ajaxGetData(url);\r\n}\r\nexport function ajaxGetItemsByCaml(properties) {\r\n    //_api/web/lists/GetByTitle('1232312312')\r\n    var query = { \"query\" :\r\n            {\"__metadata\": \r\n            { \"type\": \"SP.CamlQuery\" },\r\n                \"ViewXml\": properties.caml\r\n            }\r\n        },\r\n        headerdata = {\r\n            'Accept': 'application/json; odata=minimalmetadata',\r\n            'Content-Type': 'application/json; odata=verbose',\r\n            'X-RequestDigest': properties.context || document.getElementById('__REQUESTDIGEST').value\r\n        };\r\n\r\n    return $.ajax({\r\n        url: properties.url + '/getitems',\r\n        type: 'POST',\r\n        data: JSON.stringify(query),\r\n        headers: headerdata\r\n    });\r\n}\r\nexport function ajaxGetUserPermissions(props) {\r\n    /*\r\n        this function will give you an array of the permission a user has to a site or list/library\r\n        for a site\r\n        {\r\n            type: site,\r\n            url: \"/sites/EA/routing\", url of the site to check\r\n            userEmail: blahblah@elderaffairs.org\r\n        }\r\n        for a list / library\r\n        {\r\n            type: list,    list or library\r\n            url: \"/sites/EA/routing\", url of the site to check\r\n            userEmail: blahblah@elderaffairs.org,\r\n            listTitle: 'Route State'     listTitle or listGUID\r\n        }\r\n    */\r\n    var type = props.type ? props.type.toLowerCase() : null,\r\n        toSend;\r\n\r\n    props.encodedEmail = spUtil.encodeAccountName(props.userEmail);\r\n\r\n    if (type === 'site') {\r\n        //getting site url\r\n        checkUrlOrigin(props, \"/_api/web\");\r\n        toSend = props.configuredUrl + \"/getusereffectivepermissions(@user)?@user='\"+props.encodedEmail+\"'\";\r\n    } else if (type === 'list' || type === 'library') {\r\n        //setting up list url\r\n        listUrlConfigure(props);\r\n        toSend = props.listUrl + \"/getusereffectivepermissions(@user)?@user='\"+props.encodedEmail+\"'\";\r\n    } else {\r\n        //didnot get enough data\r\n        throw new Error('incomplete data passed to ajaxGetUserPermissions');\r\n    }\r\n\r\n\r\n\r\n    return ajaxGetData(toSend)\r\n    .then(function(response) {\r\n        props.permissions = parseBasePermissions(response);\r\n        return props;\r\n    });\r\n}\r\nexport function ajaxGetCurrentUserGroups(props) {\r\n    // porps = {\r\n    // \tuserId: 9,\r\n    // \turl: \"/sites/EA/routing\",\r\n    // }\r\n    //userid should be the id number of the person on the site - _spPageContextInfo.userId\r\n\r\n    checkUrlOrigin(props, \"/_api/web\");\r\n\r\n    return ajaxGetData(props.configuredUrl + \"/GetUserbyId(\" + props.userId + \")/Groups\")\r\n    .then(function(groups){\r\n\r\n        var groupArray = [];\r\n\r\n        groups.value.forEach(function(item) {\r\n            groupArray.push(item.Title);\r\n        });\r\n\r\n        return groupArray;\r\n\r\n    });\r\n}\r\nexport function ajaxCreateItem(properties) {\r\n    // listTitle or listGUID\r\n    // {\r\n    // \tlistName: 'routeState', optional\r\n    // \tlistTitle: 'Route State'\r\n    // \turl: \"/sites/EA/routing\",\r\n    // \tinfoToServer: {\r\n    //    Title: 'Route '+ routeId +' progress tracker',\r\n    //    TaskStatus: 'Draft',\r\n    //    parentRouteID: routeId\r\n    // }\r\n    return nonDeleteProcess(properties);\r\n}\r\nexport function ajaxUpdateItem(properties) {\r\n    // listTitle or listGUID\r\n    // {\r\n    // \tlistName: 'routeState', optional\r\n    // \tlistTitle: 'Route State'\r\n    // \turl: \"/sites/EA/routing\",\r\n    // \titemId: 3,\r\n    // \tinfoToServer: {\r\n    //    Title: 'Route '+ routeId +' progress tracker',\r\n    //    TaskStatus: 'Draft',\r\n    //    parentRouteID: routeId\r\n    // }\r\n    return nonDeleteProcess(properties, {\r\n        \"X-HTTP-Method\": \"MERGE\",\r\n        \"If-Match\": properties.etag || \"*\",\r\n    });\r\n}\r\nexport function ajaxDeleteItem(properties) {\r\n    //****be warned if you use this function, the item you delete will be gone and unrecoverable!!!!****\r\n    // listTitle or listGUID\r\n    // ajaxCreateItem({\r\n    //\t\tlistTitle: 'Route State'\r\n    //\t\turl: \"/sites/EA/routing\",\r\n    //\t\titemId: 3\r\n    // })\r\n    return deleteProcess(properties, {\r\n        'X-HTTP-Method' : 'DELETE',\r\n        \"If-Match\": properties.etag || \"*\"\r\n    });\r\n}\r\nexport function ajaxRecycleItem(properties) {\r\n    // listTitle or listGUID\r\n    // ajaxCreateItem({\r\n    //\t\tlistTitle: 'Route State'\r\n    //\t\turl: \"/sites/EA/routing\",\r\n    //\t\titemId: 3\r\n    // })\r\n    return deleteProcess(properties, null, \"/recycle\");\r\n}\r\nexport function userProfileData(origin, userEmail) {\r\n    //must pass origin, userEmail is optional\r\n    //if you dont pass userEmail then you get current logged in user\r\n\r\n    var url = createProfileUrl(origin, userEmail);\r\n    \r\n    return ajaxGetData(url)\r\n    .then(function(properties){ //success\r\n\r\n        if (properties['odata.null'] === true) {\r\n\r\n            return 'User Not Found';\r\n\r\n        } else{\r\n\r\n            return profilePropsCleaner(properties.UserProfileProperties);\r\n\r\n        }\r\n\r\n    });\r\n}\r\nexport function getListColumns(siteUrl, listId, includeAll) {\r\n\t//includeAll is for hidden and readOnly\r\n\tvar includeOthers = includeAll || false,\r\n\t\turl = siteUrl + \"/_api/web/lists(guid'\"+listId+\"')/fields?$filter=Hidden eq \"+includeOthers+\" and ReadOnlyField eq \"+ includeOthers;\r\n\r\n\treturn ajaxGetData(url);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/library.js"],"sourceRoot":""}