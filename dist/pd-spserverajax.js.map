{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap f57492dfb31f2f0d5234","webpack:///external {\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\",\"amd\":\"jquery\",\"root\":\"$\"}","webpack:///external {\"commonjs\":\"pd-sputil\",\"commonjs2\":\"pd-sputil\",\"amd\":\"pd-sputil\",\"root\":\"pdsputil\"}","webpack:///./src/library.js"],"names":["minimalMeta","ajaxJsonContentType","createlistitemtype","listName","charAt","toUpperCase","slice","guidHexCodes","createGUID","result","index","value","Math","floor","random","checkUrlOrigin","props","configuredUrl","origin","location","url","endPoint","listUrlConfigure","listUrl","listGUID","listTitle","listItemUrlConfigure","item","itemId","listItemUrl","getEntityType","entityData","resolve","ajaxGetListInfo","then","data","ListItemEntityTypeFullName","nonDeleteProcess","headerData","type","infoToServer","ajaxGetContext","context","FormDigestValue","Accept","contentType","JSON","stringify","headers","deleteProcess","urlModifier","parseBasePermissions","permissions","SP","BasePermissions","initPropertiesFromJson","permLevels","permLevelName","PermissionKind","prototype","hasOwnProperty","permLevel","parse","has","push","createGetAllUrl","select","top","expand","filter","orderBy","test","ajaxGetUserPermissions","ajaxGetData","permsLink","response","method","ajaxGetAllListResults","reject","currentResults","allResults","concat","ajaxGetBatch","arrayOfUrls","batchGUID","batchBody","batchHeader","batchContents","forEach","join","parsedArray","responseToArray","split","currentLine","length","tryParseJson","e","ajaxPeopleSearch","serverQueryData","startrow","rowlimit","TrimDuplicates","selectproperties","profileProps","sourceid","sourceId","querytext","query","empData","relevantResults","PrimaryQueryResult","RelevantResults","Table","Rows","TotalRows","RowCount","ajaxEnsureUser","encodeAccountName","email","ajaxGetSiteUserInfoByEmail","ajaxGetItemsByCaml","caml","headerdata","ajaxGetUserSitePermissions","encodedEmail","permLink","ajaxGetUserListPermissions","ajaxGetCurrentUserGroups","userId","groups","groupArray","Title","ajaxCreateItem","ajaxUpdateItem","etag","ajaxDeleteItem","ajaxRecycleItem","userProfileData","addon","userData","UserProfileProperties","getListColumns","allData"],"mappings":"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","file":"pd-spserverajax.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"jquery\"), require(\"pd-sputil\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"jquery\", \"pd-sputil\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"pdspserverajax\"] = factory(require(\"jquery\"), require(\"pd-sputil\"));\n\telse\n\t\troot[\"pdspserverajax\"] = factory(root[\"$\"], root[\"pdsputil\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_1__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f57492dfb31f2f0d5234","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\",\"amd\":\"jquery\",\"root\":\"$\"}\n// module id = 0\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"pd-sputil\",\"commonjs2\":\"pd-sputil\",\"amd\":\"pd-sputil\",\"root\":\"pdsputil\"}\n// module id = 1\n// module chunks = 0","/**\r\n    app name pd-spservercontacts\r\n */\r\nimport * as $ from \"jquery\";\r\nimport {encodeAccountName, profileProps} from \"pd-sputil\";\r\n\r\nconst minimalMeta = \"application/json;odata=minimalmetadata\";\r\nconst ajaxJsonContentType = \"application/json;odata=verbose\";\r\nconst createlistitemtype = function(listName) {\r\n    return 'SP.Data.' + \r\n        listName.charAt(0).toUpperCase() + \r\n        listName.slice(1) + \r\n        'ListItem';\r\n};\r\nconst guidHexCodes = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'];\r\nconst createGUID = function() {\r\n    var result = '';\r\n\r\n    for (var index = 0; index < 32; index++) {\r\n        var value = Math.floor(Math.random() * 16);\r\n\r\n        switch (index) {\r\n        case 8:\r\n            result += '-';\r\n            break;\r\n        case 12:\r\n            value = 4;\r\n            result += '-';\r\n            break;\r\n        case 16:\r\n            value = value & 3 | 8;\r\n            result += '-';\r\n            break;\r\n        case 20:\r\n            result += '-';\r\n            break;\r\n        }\r\n        result += guidHexCodes[value];\r\n    }\r\n    return result;\r\n};\r\nconst checkUrlOrigin = function(props) {\r\n\r\n    props.configuredUrl = props.origin || location.origin;\r\n\r\n    if(props.url) {\r\n        props.configuredUrl += props.url;\r\n    }\r\n\r\n    if(props.endPoint) {\r\n        props.configuredUrl += `/${props.endPoint}`;\r\n    }\r\n    return props;\r\n\r\n    //fell through so the incorrect datatype was passed to function, error\r\n};\r\nconst listUrlConfigure = function(props) {\r\n\r\n    if (!props.url || props.listUrl) {\r\n        return;\r\n    }\r\n\r\n    props.endPoint = \"_api/web\";\r\n\r\n    checkUrlOrigin(props);\r\n\r\n    if (props.listGUID) {\r\n        props.listUrl = props.configuredUrl += \"/lists(guid'\"+ props.listGUID +\"')\";\r\n    } else if (props.listTitle) {\r\n        props.listUrl = props.configuredUrl += \"/lists/getbytitle('\"+ props.listTitle +\"')\";\r\n    }\r\n    return props;\r\n};\r\nconst listItemUrlConfigure = function(props) {\r\n    //for create, update, delete\r\n    var item = props.itemId || '';\r\n\r\n    if (props.listItemUrl) {\r\n        return;\r\n    }\r\n\r\n    listUrlConfigure(props);\r\n\r\n    props.listItemUrl = props.listUrl += \"/items(\"+ item +\")\";\r\n    return props;\r\n};\r\nconst getEntityType = function(props) {\r\n\r\n    var entityData;\r\n\r\n    if (props.listName) {\r\n        entityData = createlistitemtype(props.listName);\r\n        return $.Deferred().resolve(entityData);\r\n    }\r\n\r\n    return ajaxGetListInfo(props)\r\n    .then(function(data) {\r\n        return data.ListItemEntityTypeFullName;\r\n    });\r\n};\r\nconst nonDeleteProcess = function(props) {\r\n\r\n    if(!props.headerData) {\r\n        props.headerData = {};\r\n    }\r\n\r\n    return getEntityType(props)\r\n    .then(function(type) {\r\n        props.item = $.extend({\r\n            '__metadata': {'type': type}\r\n        }, props.infoToServer);\r\n\r\n        return ajaxGetContext(props.url);\r\n    }).then(function(context) {\r\n\r\n        props.headerData['X-RequestDigest'] = context.FormDigestValue;\r\n        props.headerData.Accept = 'application/json; odata=minimalmetadata';\r\n\r\n        listItemUrlConfigure(props);\r\n\r\n        return $.ajax({\r\n            url: props.listItemUrl,\r\n            type: 'POST',\r\n            contentType: 'application/json;odata=verbose',\r\n            data: JSON.stringify(props.item),\r\n            headers: props.headerData\r\n        });\r\n    });\r\n};\r\nconst deleteProcess = function(props) {\r\n\r\n    if(!props.headerData) {\r\n        props.headerData = {};\r\n    }\r\n\r\n    return ajaxGetContext(props.url)\r\n    .then(function(context) {\r\n\r\n        props.headerData['X-RequestDigest'] = context.FormDigestValue;\r\n        props.headerData.Accept = 'application/json; odata=minimalmetadata';\r\n\r\n        listItemUrlConfigure(props);\r\n\r\n        if (props.urlModifier) {\r\n            props.listItemUrl += props.urlModifier;\r\n        }\r\n\r\n        return $.ajax({\r\n            url: props.listItemUrl,\r\n            type: 'POST',\r\n            contentType: 'application/json;odata=verbose',\r\n            headers: props.headerData\r\n        });\r\n    });\r\n};\r\nconst parseBasePermissions = function(value) {\r\n    var permissions = new SP.BasePermissions();\r\n    permissions.initPropertiesFromJson(value);\r\n    var permLevels = [];\r\n    for(var permLevelName in SP.PermissionKind.prototype) {\r\n        if (SP.PermissionKind.hasOwnProperty(permLevelName)) {\r\n            var permLevel = SP.PermissionKind.parse(permLevelName);\r\n            if(permissions.has(permLevel)){\r\n                    permLevels.push(permLevelName);\r\n            }\r\n        }     \r\n    }\r\n    return permLevels;   \r\n};\r\nconst createGetAllUrl = function(props) {\r\n\r\n    if(props.listUrl) {\r\n        //already setup, get out\r\n        return;\r\n    }\r\n    if(!props.endPoint) {\r\n        props.endPoint = \"_api/web\";\r\n    }\r\n    listUrlConfigure(props);\r\n\r\n    props.listUrl += \"/items?\";\r\n\r\n    if(props.select) {\r\n        props.listUrl += `$select=${props.select}&`;\r\n    }\r\n    if(props.top) {\r\n        props.listUrl += `$top=${props.top}&`;\r\n    }\r\n    if(props.expand) {\r\n        props.listUrl += `$expand=${props.expand}&`;\r\n    }\r\n    if(props.filter) {\r\n        props.listUrl += `$filter=${props.filter}&`;\r\n    }\r\n    if(props.orderBy) {\r\n        props.listUrl += `$orderby=${props.orderBy}&`;\r\n    }\r\n\r\n    if(/\\$$/.test(props.listUrl)) {\r\n        //if $ is the last character then get rid of it\r\n        props.listUrl.slice(0,-1);\r\n    }\r\n\r\n};\r\nconst ajaxGetUserPermissions = function(props) {\r\n\r\n    return ajaxGetData(props.permsLink)\r\n    .then(function(response) {\r\n        return parseBasePermissions(response);\r\n    });\r\n};\r\n\r\n/**\r\n * Gets a context object for server requests.\r\n * origin is optional\r\n * url is site relative url\r\n * returns a jquery promise\r\n * the key from response is FormDigestValue\r\n * @param {{origin:string, url:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetContext(props) {\r\n    \r\n    props.endPoint = \"_api/contextinfo\";\r\n    checkUrlOrigin(props);\r\n\r\n    return $.ajax({\r\n        url: props.configuredUrl,\r\n        method: \"POST\",\r\n        headers: { \"Accept\": \"application/json; odata=minimalmetadata\" }\r\n    }).then((response) => {\r\n        props.endPoint = null;\r\n        props.configuredUrl = null;\r\n        return response;\r\n    });\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * url is full odata url\r\n * @param {string} url\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetData(url) {\r\n    return $.ajax({\r\n        url: url,\r\n        type: 'GET',\r\n        headers: {'Accept': 'application/json; odata=minimalmetadata'}\r\n    });\r\n}\r\n/**\r\n * Gets all results for server requests.\r\n * url is site relative url\r\n * either pass listGUID or listTitle but not both\r\n * \r\n * the following are optional\r\n * origin\r\n * select\r\n * filter\r\n * expand\r\n * top\r\n * orderby\r\n * \r\n * returns a jquery promise\r\n * once the promise resolves you get an array of objects that are the servers response\r\n * @param {{origin:string, url:string, listGUID:string, listTitle:string, select:string, filter:string, expand:string, top:string, orderBy:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetAllListResults(props) {\r\n\r\n    if(!props.listGUID && !props.listTitle) {\r\n        return $.Deferred().reject(\"must pass listGUID or listTitle to ajaxGetAllListResults\");\r\n    }\r\n\r\n    createGetAllUrl(props);\r\n\r\n    return ajaxGetData(props.listUrl)\r\n    .then(function(response) {\r\n        var url,\r\n            currentResults = props.allResults || [];\r\n\r\n        props.allResults = currentResults.concat(response.value);\r\n        \r\n        if (response['odata.nextLink']) {\r\n            props.listUrl = response['odata.nextLink'];\r\n            return ajaxGetAllListResults(props);\r\n        }\r\n        return props.allResults;\r\n    });\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * origin is optional\r\n * once the promise resolves you get an array of objects that are the servers response\r\n * @param {{origin:string, url:string}} url\r\n * @param {string[]} arrayOfUrls\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetBatch(props, arrayOfUrls) {\r\n\r\n    var batchGUID = createGUID(),\r\n        batchBody,\r\n        batchHeader,\r\n        batchContents = [];\r\n\r\n    //batch (operation)\r\n    arrayOfUrls.forEach(function(item) {\r\n        batchContents.push('--batch_' + batchGUID);\r\n        batchContents.push('Content-Type: application/http');\r\n        batchContents.push('Content-Transfer-Encoding: binary');\r\n        batchContents.push('');\r\n        batchContents.push('GET ' + item + ' HTTP/1.1');\r\n        batchContents.push('Accept: application/json;odata=minimalmetadata');\r\n        batchContents.push('');\r\n    });\r\n\r\n    batchContents.push('--batch_' + batchGUID + '--');\r\n\r\n    batchBody = batchContents.join('\\r\\n');\r\n\r\n    return ajaxGetContext(props)\r\n    .then((response) => {\r\n\r\n        props.endPoint = '_api/$batch';\r\n        checkUrlOrigin(props);\r\n\r\n        batchHeader = {\r\n        'X-RequestDigest': response.FormDigestValue,\r\n        'Content-Type': 'multipart/mixed; boundary=\"batch_' + batchGUID + '\"'\r\n        };\r\n        \r\n        \r\n        return $.ajax({\r\n            url: props.configuredUrl,\r\n            type: 'POST',\r\n            data: batchBody,\r\n            headers: batchHeader\r\n        }).then(function(response) {\r\n            var parsedArray = [],\r\n                responseToArray = response.split('\\n');\r\n\r\n            for (var currentLine = 0; currentLine < responseToArray.length; currentLine++) {\r\n                if (responseToArray[currentLine].charAt(0) === '{') {\r\n                try {\r\n                    // parse the JSON response...\r\n                    var tryParseJson = JSON.parse(responseToArray[currentLine]);\r\n\r\n                    parsedArray.push(tryParseJson);\r\n\r\n                } catch (e) {\r\n                    // don't do anything... just keep moving\r\n                }\r\n                }\r\n            }\r\n\r\n            return parsedArray;\r\n\r\n        });\r\n    });\r\n\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * data contained in response is the properties for a list\r\n * origin is optional\r\n * url is site relative url\r\n * pass listTitle or listGUID not both\r\n * @param {{origin:string, url:string, listGUID:string, listTitle:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetListInfo(props) {\r\n\r\n    listUrlConfigure(props);\r\n    return ajaxGetData(props.listUrl);\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * data contained in response is the people info\r\n * origin optional\r\n * url is site relative url optional\r\n * sourceId optional\r\n * query required, ex \"'\" + 'Bureau=\"'+ divisionName + '\"\\''\r\n * @param {{origin:string, url:string, query:string, sourceId:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxPeopleSearch(props) {\r\n\r\n    var allResults = props.currentResults || [],\r\n        serverQueryData = {\r\n            startrow: 0,\r\n            rowlimit: 500,\r\n            TrimDuplicates: false,\r\n            selectproperties: \"'\" + profileProps.join(',') + \"'\"\r\n        };\r\n\r\n    serverQueryData.startrow = props.startrow ? props.startrow : 0;\r\n    serverQueryData.sourceid = props.sourceId ? props.sourceId : 'b09a7990-05ea-4af9-81ef-edfab16c4e31';\r\n\r\n    //setup search url\r\n    if(!props.url) {\r\n        //default search site\r\n        props.url = '/search';\r\n    }\r\n\r\n    props.endPoint = \"_api/search/query\";\r\n    serverQueryData.querytext = props.query;\r\n\r\n    checkUrlOrigin(props);\r\n\r\n    return $.ajax({\r\n        url: props.configuredUrl,\r\n        type: 'GET',\r\n        headers: {'Accept': 'application/json; odata=minimalmetadata'},\r\n        data: serverQueryData\r\n    }).then(function(empData) {\r\n\r\n        var relevantResults = empData.PrimaryQueryResult.RelevantResults;\r\n\r\n        allResults = allResults.concat(relevantResults.Table.Rows);\r\n        props.currentResults = allResults;\r\n\r\n        if (relevantResults.TotalRows > (serverQueryData.startrow + relevantResults.RowCount)) {\r\n            props.startrow = serverQueryData.startrow + relevantResults.RowCount;\r\n            return ajaxPeopleSearch(props);\r\n        } else {\r\n            return props.currentResults;\r\n        }\r\n    });\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * data contained in response is the users info\r\n * origin is optional\r\n * url is site relative url\r\n * email is the email address of the user\r\n * @param {{origin:string, url:string, email:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxEnsureUser(props) {\r\n    \r\n    return ajaxGetContext(props)\r\n    .then((response) => {\r\n    \r\n        props.endPoint = \"_api/web\";\r\n        checkUrlOrigin(props);\r\n        props.configuredUrl += `/ensureUser('${encodeAccountName(props.email)}')`;\r\n\r\n        return $.ajax({       \r\n            url: props.configuredUrl,   \r\n            type: \"POST\",  \r\n            contentType: ajaxJsonContentType,\r\n            headers: { \r\n                \"Accept\": minimalMeta,\r\n                \"X-RequestDigest\": response.FormDigestValue\r\n            }\r\n        });\r\n    });\r\n\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * data contained in response is the users info\r\n * origin is optional\r\n * url is site relative url\r\n * email is the email address of the user\r\n * @param {{origin:string, url:string, email:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetSiteUserInfoByEmail(props) {\r\n\r\n    props.endPoint = \"_api/web/siteusers\";\r\n    checkUrlOrigin(props);\r\n\r\n    props.configuredUrl += `?$filter=LoginName eq '${encodeAccountName(props.email)}'`;\r\n\r\n    return ajaxGetData(props.configuredUrl);\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * get results from a caml query\r\n * origin is optional\r\n * url is site relative url\r\n * caml is the query\r\n * pass eiter list giud or list title, not both\r\n * @param {{origin:string, url:string, query:string, listGUID:string, listTitle:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetItemsByCaml(props) {\r\n\r\n    return ajaxGetContext(props)\r\n    .then((response) => {\r\n\r\n        let query = { \"query\" :\r\n            {\"__metadata\": \r\n            { \"type\": \"SP.CamlQuery\" },\r\n                \"ViewXml\": props.caml\r\n            }\r\n        },\r\n        headerdata = {\r\n            'Accept': 'application/json; odata=minimalmetadata',\r\n            'Content-Type': 'application/json; odata=verbose',\r\n            'X-RequestDigest': response.FormDigestValue\r\n        };\r\n\r\n        listUrlConfigure(props);\r\n        props.listUrl += '/getitems';\r\n\r\n        return $.ajax({\r\n            url: props.configuredUrl,\r\n            type: 'POST',\r\n            data: JSON.stringify(query),\r\n            headers: headerdata\r\n        });\r\n    });\r\n\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * get a users permissions to site\r\n * the resolve is an array of permission for the user\r\n * origin is optional\r\n * url is site relative url\r\n * @param {{origin:string, url:string, email:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetUserSitePermissions(props) {\r\n\r\n    let encodedEmail = encodeAccountName(props.email);\r\n\r\n    props.endPoint = \"_api/web\";\r\n    checkUrlOrigin(props);\r\n\r\n    props.permLink = `${props.configuredUrl}/getusereffectivepermissions(@user)?@user='${encodedEmail}'`;\r\n    return ajaxGetUserPermissions(props);\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * get a users permissions to list\r\n * the resolve is an array of permission for the user\r\n * origin is optional\r\n * url is site relative url\r\n * caml is the query\r\n * pass eiter list giud or list title, not both\r\n * @param {{origin:string, url:string, email:string, listGUID:string, listTitle:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetUserListPermissions(props) {\r\n\r\n    let encodedEmail = encodeAccountName(props.email);\r\n\r\n    listUrlConfigure(props);\r\n\r\n    props.permLink = `${props.listUrl}/getusereffectivepermissions(@user)?@user='${encodedEmail}'`;\r\n    return ajaxGetUserPermissions(props);\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * get the SP groups that a user is apart of\r\n * the resolve is an array of group names\r\n * origin is optional\r\n * url is site relative url\r\n * userId is the id of user in the site\r\n * @param {{origin:string, url:string, userId:number}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetCurrentUserGroups(props) {\r\n\r\n    props.endPoint = \"/_api/web\";\r\n    checkUrlOrigin(props);\r\n\r\n    props.configuredUrl += `/GetUserbyId(${props.userId})/Groups`;\r\n\r\n    return ajaxGetData(props.configuredUrl)\r\n    .then(function(groups){\r\n\r\n        var groupArray = [];\r\n\r\n        groups.value.forEach(function(item) {\r\n            groupArray.push(item.Title);\r\n        });\r\n\r\n        return groupArray;\r\n\r\n    });\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * creates an item in the list that is passed\r\n * the resolve is an object with the created item info\r\n * origin is optional\r\n * url is site relative url\r\n * listName is optional\r\n * pass either listTitle or listGUID not both\r\n * infoToServer should be a object whos key is the column name and the value is what you want stored in that column\r\n * @param {{origin:string, url:string, listName:string, listTitle:string, listGUID:string, infoToServer:object}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxCreateItem(props) {\r\n    return nonDeleteProcess(props);\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * updates an item in the list that is passed\r\n * the resolve is an object with the update item info\r\n * origin is optional\r\n * url is site relative url\r\n * listName is optional\r\n * pass either listTitle or listGUID not both\r\n * itemId is the id number of the item to be updated\r\n * infoToServer should be a object whos key is the column name and the value is what you want stored in that column\r\n * @param {{origin:string, url:string, listName:string, listTitle:string, listGUID:string, itemId:number, infoToServer:object}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxUpdateItem(props) {\r\n    // listTitle or listGUID\r\n    // {\r\n    //  origin: ,\r\n    // \tlistName: 'routeState', optional\r\n    // \tlistTitle: 'Route State'\r\n    // \turl: \"/sites/EA/routing\",\r\n    // \titemId: 3,\r\n    // \tinfoToServer: {\r\n    //    Title: 'Route '+ routeId +' progress tracker',\r\n    //    TaskStatus: 'Draft',\r\n    //    parentRouteID: routeId\r\n    // }\r\n\r\n    props.headerData = {\r\n        \"X-HTTP-Method\": \"MERGE\",\r\n        \"If-Match\": props.etag || \"*\"\r\n    };\r\n    return nonDeleteProcess(props);\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * deletes an item in the list that is passed\r\n * origin is optional\r\n * url is site relative url\r\n * pass either listTitle or listGUID not both\r\n * itemId is the id number of the item to be deleted\r\n * etag is optional\r\n * be warned if you use this function, the item you delete will be gone and unrecoverable!!!!\r\n * @param {{origin:string, url:string, listTitle:string, listGUID:string, itemId:number, etag:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxDeleteItem(props) {\r\n    //todo try to complete this function without an etag\r\n    props.headerData = {\r\n        'X-HTTP-Method' : 'DELETE',\r\n        \"If-Match\": props.etag || \"*\"\r\n    };\r\n    return deleteProcess(props);\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * recycles an item in the list that is passed\r\n * origin is optional\r\n * url is site relative url\r\n * pass either listTitle or listGUID not both\r\n * itemId is the id number of the item to be recycled\r\n * @param {{origin:string, url:string, listTitle:string, listGUID:string, itemId:number}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxRecycleItem(props) {\r\n\r\n    props.urlModifier = \"/recycle\";\r\n    return deleteProcess(props);\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * retrieves profile properties for the user email passed\r\n * if you do not pass a user email it retrieves the current user\r\n * origin is optional\r\n * email is optional\r\n * @param {{origin:string, email:string}} props\r\n * @returns {promise}\r\n */\r\nexport function userProfileData(props) {\r\n\r\n    let addon = null;\r\n\r\n    checkUrlOrigin(props);\r\n\r\n    if(props.email) {\r\n        props.endPoint = '_api/sp.userprofiles.peoplemanager';\r\n        addon = `/getpropertiesfor(@v)?@v='${encodeAccountName(props.email)}'&`;\r\n    } else {\r\n        //url for get current user\r\n        props.endPoint = '_api/SP.UserProfiles.PeopleManager/GetMyProperties';\r\n        addon = '?';\r\n    }\r\n    props.configuredUrl += `${addon}$select=UserProfileProperties`;\r\n    \r\n    return ajaxGetData(props.configuredUrl)\r\n    .then(function(userData){ //success\r\n        if (userData['odata.null'] === true) {\r\n            return [];\r\n        } else{\r\n            return userData.UserProfileProperties;\r\n        }\r\n    });\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * retrieves the columns of the passed list\r\n * origin is optional\r\n * url is a site relative url\r\n * pass listGUID or listTitle not both\r\n * allData is optional, it will include all hidden and readonly if you pass true\r\n * @param {{origin:string, url:string, listGUID:string, listTitle:string, allData:boolean}} props\r\n * @returns {promise}\r\n */\r\nexport function getListColumns(props) {\r\n\r\n    if(!props.allData) {\r\n        props.allData = false;\r\n    }\r\n    listUrlConfigure(props);\r\n    props.listUrl += `/fields?$filter=Hidden eq ${props.allData} and ReadOnlyField eq ${props.allData}`;\r\n\r\n\treturn ajaxGetData(props.listUrl);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/library.js"],"sourceRoot":""}