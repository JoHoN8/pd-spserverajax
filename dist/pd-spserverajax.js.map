{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 70b01e892b92dd9d7841","webpack:///external {\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\",\"amd\":\"jquery\",\"root\":\"$\"}","webpack:///external {\"commonjs\":\"pd-sputil\",\"commonjs2\":\"pd-sputil\",\"amd\":\"pd-sputi\",\"root\":\"pdspBase\"}","webpack:///./src/library.js"],"names":["ajaxGetContext","ajaxGetData","ajaxGetAllListResults","ajaxGetBatch","ajaxGetListInfo","ajaxPeopleSearch","ajaxEnsureUser","ajaxGetSiteUserInfoByEmail","ajaxGetItemsByCaml","ajaxGetUserSitePermissions","ajaxGetUserListPermissions","ajaxGetCurrentUserGroups","ajaxCreateItem","ajaxUpdateItem","ajaxDeleteItem","ajaxRecycleItem","userProfileData","getListColumns","$","spu","minimalMeta","ajaxJsonContentType","createlistitemtype","listName","charAt","toUpperCase","slice","guidHexCodes","createGUID","result","index","value","Math","floor","random","checkUrlOrigin","props","configuredUrl","origin","location","url","endPoint","listUrlConfigure","listUrl","listGUID","listTitle","listItemUrlConfigure","item","itemId","listItemUrl","getEntityType","entityData","Deferred","resolve","then","data","ListItemEntityTypeFullName","nonDeleteProcess","headerData","type","extend","infoToServer","context","FormDigestValue","Accept","ajax","contentType","JSON","stringify","headers","deleteProcess","urlModifier","parseBasePermissions","permissions","SP","BasePermissions","initPropertiesFromJson","permLevels","permLevelName","PermissionKind","prototype","hasOwnProperty","permLevel","parse","has","push","createGetAllUrl","select","top","expand","filter","orderBy","test","ajaxGetUserPermissions","permsLink","response","method","reject","currentResults","allResults","concat","arrayOfUrls","batchGUID","batchBody","batchHeader","batchContents","forEach","join","parsedArray","responseToArray","split","currentLine","length","tryParseJson","e","serverQueryData","startrow","rowlimit","TrimDuplicates","selectproperties","profileProperties","sourceid","sourceId","querytext","query","empData","relevantResults","PrimaryQueryResult","RelevantResults","Table","Rows","TotalRows","RowCount","encodeAccountName","email","caml","headerdata","encodedEmail","permLink","userId","groups","groupArray","Title","etag","addon","userData","UserProfileProperties","allData"],"mappings":"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","file":"pd-spserverajax.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"jquery\"), require(\"pd-sputil\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"jquery\", \"pd-sputi\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"pdspserverajax\"] = factory(require(\"jquery\"), require(\"pd-sputil\"));\n\telse\n\t\troot[\"pdspserverajax\"] = factory(root[\"$\"], root[\"pdspBase\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_1__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 70b01e892b92dd9d7841","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\",\"amd\":\"jquery\",\"root\":\"$\"}\n// module id = 0\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"pd-sputil\",\"commonjs2\":\"pd-sputil\",\"amd\":\"pd-sputi\",\"root\":\"pdspBase\"}\n// module id = 1\n// module chunks = 0","/**\r\n    app name pd-spservercontacts\r\n */\r\nimport * as $ from \"jquery\";\r\nimport * as spu from \"pd-sputil\";\r\n\r\nconst minimalMeta = \"application/json;odata=minimalmetadata\";\r\nconst ajaxJsonContentType = \"application/json;odata=verbose\";\r\nconst createlistitemtype = function(listName) {\r\n    return 'SP.Data.' + \r\n        listName.charAt(0).toUpperCase() + \r\n        listName.slice(1) + \r\n        'ListItem';\r\n};\r\nconst guidHexCodes = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'];\r\nconst createGUID = function() {\r\n    var result = '';\r\n\r\n    for (var index = 0; index < 32; index++) {\r\n        var value = Math.floor(Math.random() * 16);\r\n\r\n        switch (index) {\r\n        case 8:\r\n            result += '-';\r\n            break;\r\n        case 12:\r\n            value = 4;\r\n            result += '-';\r\n            break;\r\n        case 16:\r\n            value = value & 3 | 8;\r\n            result += '-';\r\n            break;\r\n        case 20:\r\n            result += '-';\r\n            break;\r\n        }\r\n        result += guidHexCodes[value];\r\n    }\r\n    return result;\r\n};\r\nconst checkUrlOrigin = function(props) {\r\n\r\n    props.configuredUrl = props.origin || location.origin;\r\n\r\n    if(props.url) {\r\n        props.configuredUrl += props.url;\r\n    }\r\n\r\n    if(props.endPoint) {\r\n        props.configuredUrl += `/${props.endPoint}`;\r\n    }\r\n    return props;\r\n\r\n    //fell through so the incorrect datatype was passed to function, error\r\n};\r\nconst listUrlConfigure = function(props) {\r\n\r\n    if (!props.url || props.listUrl) {\r\n        return;\r\n    }\r\n\r\n    props.endPoint = \"_api/web\";\r\n\r\n    checkUrlOrigin(props);\r\n\r\n    if (props.listGUID) {\r\n        props.listUrl = props.configuredUrl += \"/lists(guid'\"+ props.listGUID +\"')\";\r\n    } else if (props.listTitle) {\r\n        props.listUrl = props.configuredUrl += \"/lists/getbytitle('\"+ props.listTitle +\"')\";\r\n    }\r\n    return props;\r\n};\r\nconst listItemUrlConfigure = function(props) {\r\n    //for create, update, delete\r\n    var item = props.itemId || '';\r\n\r\n    if (props.listItemUrl) {\r\n        return;\r\n    }\r\n\r\n    listUrlConfigure(props);\r\n\r\n    props.listItemUrl = props.listUrl += \"/items(\"+ item +\")\";\r\n    return props;\r\n};\r\nconst getEntityType = function(props) {\r\n\r\n    var entityData;\r\n\r\n    if (props.listName) {\r\n        entityData = createlistitemtype(props.listName);\r\n        return $.Deferred().resolve(entityData);\r\n    }\r\n\r\n    return ajaxGetListInfo(props)\r\n    .then(function(data) {\r\n        return data.ListItemEntityTypeFullName;\r\n    });\r\n};\r\nconst nonDeleteProcess = function(props) {\r\n\r\n    if(!props.headerData) {\r\n        props.headerData = {};\r\n    }\r\n\r\n    return getEntityType(props)\r\n    .then(function(type) {\r\n        props.item = $.extend({\r\n            '__metadata': {'type': type}\r\n        }, props.infoToServer);\r\n\r\n        return ajaxGetContext(props.url);\r\n    }).then(function(context) {\r\n\r\n        props.headerData['X-RequestDigest'] = context.FormDigestValue;\r\n        props.headerData.Accept = 'application/json; odata=minimalmetadata';\r\n\r\n        listItemUrlConfigure(props);\r\n\r\n        return $.ajax({\r\n            url: props.listItemUrl,\r\n            type: 'POST',\r\n            contentType: 'application/json;odata=verbose',\r\n            data: JSON.stringify(props.item),\r\n            headers: props.headerData\r\n        });\r\n    });\r\n};\r\nconst deleteProcess = function(props) {\r\n\r\n    if(!props.headerData) {\r\n        props.headerData = {};\r\n    }\r\n\r\n    return ajaxGetContext(props.url)\r\n    .then(function(context) {\r\n\r\n        props.headerData['X-RequestDigest'] = context.FormDigestValue;\r\n        props.headerData.Accept = 'application/json; odata=minimalmetadata';\r\n\r\n        listItemUrlConfigure(props);\r\n\r\n        if (props.urlModifier) {\r\n            props.listItemUrl += props.urlModifier;\r\n        }\r\n\r\n        return $.ajax({\r\n            url: props.listItemUrl,\r\n            type: 'POST',\r\n            contentType: 'application/json;odata=verbose',\r\n            headers: props.headerData\r\n        });\r\n    });\r\n};\r\nconst parseBasePermissions = function(value) {\r\n    var permissions = new SP.BasePermissions();\r\n    permissions.initPropertiesFromJson(value);\r\n    var permLevels = [];\r\n    for(var permLevelName in SP.PermissionKind.prototype) {\r\n        if (SP.PermissionKind.hasOwnProperty(permLevelName)) {\r\n            var permLevel = SP.PermissionKind.parse(permLevelName);\r\n            if(permissions.has(permLevel)){\r\n                    permLevels.push(permLevelName);\r\n            }\r\n        }     \r\n    }\r\n    return permLevels;   \r\n};\r\nconst createGetAllUrl = function(props) {\r\n\r\n    if(props.listUrl) {\r\n        //already setup, get out\r\n        return;\r\n    }\r\n    if(!props.endPoint) {\r\n        props.endPoint = \"_api/web\";\r\n    }\r\n    listUrlConfigure(props);\r\n\r\n    props.listUrl += \"/items?\";\r\n\r\n    if(props.select) {\r\n        props.listUrl += `$select=${props.select}&`;\r\n    }\r\n    if(props.top) {\r\n        props.listUrl += `$top=${props.top}&`;\r\n    }\r\n    if(props.expand) {\r\n        props.listUrl += `$expand=${props.expand}&`;\r\n    }\r\n    if(props.filter) {\r\n        props.listUrl += `$filter=${props.filter}&`;\r\n    }\r\n    if(props.orderBy) {\r\n        props.listUrl += `$orderby=${props.orderBy}&`;\r\n    }\r\n\r\n    if(/\\$$/.test(props.listUrl)) {\r\n        //if $ is the last character then get rid of it\r\n        props.listUrl.slice(0,-1);\r\n    }\r\n\r\n};\r\nconst ajaxGetUserPermissions = function(props) {\r\n\r\n    return ajaxGetData(props.permsLink)\r\n    .then(function(response) {\r\n        return parseBasePermissions(response);\r\n    });\r\n};\r\n\r\n/**\r\n * Gets a context object for server requests.\r\n * origin is optional\r\n * url is site relative url\r\n * returns a jquery promise\r\n * the key from response is FormDigestValue\r\n * @param {{origin:string, url:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetContext(props) {\r\n    \r\n    props.endPoint = \"_api/contextinfo\";\r\n    checkUrlOrigin(props);\r\n\r\n    return $.ajax({\r\n        url: props.configuredUrl,\r\n        method: \"POST\",\r\n        headers: { \"Accept\": \"application/json; odata=minimalmetadata\" }\r\n    }).then((response) => {\r\n        props.endPoint = null;\r\n        props.configuredUrl = null;\r\n        return response;\r\n    });\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * url is full odata url\r\n * @param {string} url\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetData(url) {\r\n    return $.ajax({\r\n        url: url,\r\n        type: 'GET',\r\n        headers: {'Accept': 'application/json; odata=minimalmetadata'}\r\n    });\r\n}\r\n/**\r\n * Gets all results for server requests.\r\n * url is site relative url\r\n * either pass listGUID or listTitle but not both\r\n * \r\n * the following are optional\r\n * origin\r\n * select\r\n * filter\r\n * expand\r\n * top\r\n * orderby\r\n * \r\n * returns a jquery promise\r\n * once the promise resolves you get an array of objects that are the servers response\r\n * @param {{origin:string, url:string, listGUID:string, listTitle:string, select:string, filter:string, expand:string, top:string, orderBy:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetAllListResults(props) {\r\n\r\n    if(!props.listGUID && !props.listTitle) {\r\n        return $.Deferred().reject(\"must pass listGUID or listTitle to ajaxGetAllListResults\");\r\n    }\r\n\r\n    createGetAllUrl(props);\r\n\r\n    return ajaxGetData(props.listUrl)\r\n    .then(function(response) {\r\n        var url,\r\n            currentResults = props.allResults || [];\r\n\r\n        props.allResults = currentResults.concat(response.value);\r\n        \r\n        if (response['odata.nextLink']) {\r\n            props.listUrl = response['odata.nextLink'];\r\n            return ajaxGetAllListResults(props);\r\n        }\r\n        return props.allResults;\r\n    });\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * origin is optional\r\n * once the promise resolves you get an array of objects that are the servers response\r\n * @param {{origin:string, url:string}} url\r\n * @param {string[]} arrayOfUrls\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetBatch(props, arrayOfUrls) {\r\n\r\n    var batchGUID = createGUID(),\r\n        batchBody,\r\n        batchHeader,\r\n        batchContents = [];\r\n\r\n    //batch (operation)\r\n    arrayOfUrls.forEach(function(item) {\r\n        batchContents.push('--batch_' + batchGUID);\r\n        batchContents.push('Content-Type: application/http');\r\n        batchContents.push('Content-Transfer-Encoding: binary');\r\n        batchContents.push('');\r\n        batchContents.push('GET ' + item + ' HTTP/1.1');\r\n        batchContents.push('Accept: application/json;odata=minimalmetadata');\r\n        batchContents.push('');\r\n    });\r\n\r\n    batchContents.push('--batch_' + batchGUID + '--');\r\n\r\n    batchBody = batchContents.join('\\r\\n');\r\n\r\n    return ajaxGetContext(props)\r\n    .then((response) => {\r\n\r\n        props.endPoint = '_api/$batch';\r\n        checkUrlOrigin(props);\r\n\r\n        batchHeader = {\r\n        'X-RequestDigest': response.FormDigestValue,\r\n        'Content-Type': 'multipart/mixed; boundary=\"batch_' + batchGUID + '\"'\r\n        };\r\n        \r\n        \r\n        return $.ajax({\r\n            url: props.configuredUrl,\r\n            type: 'POST',\r\n            data: batchBody,\r\n            headers: batchHeader\r\n        }).then(function(response) {\r\n            var parsedArray = [],\r\n                responseToArray = response.split('\\n');\r\n\r\n            for (var currentLine = 0; currentLine < responseToArray.length; currentLine++) {\r\n                if (responseToArray[currentLine].charAt(0) === '{') {\r\n                try {\r\n                    // parse the JSON response...\r\n                    var tryParseJson = JSON.parse(responseToArray[currentLine]);\r\n\r\n                    parsedArray.push(tryParseJson);\r\n\r\n                } catch (e) {\r\n                    // don't do anything... just keep moving\r\n                }\r\n                }\r\n            }\r\n\r\n            return parsedArray;\r\n\r\n        });\r\n    });\r\n\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * data contained in response is the properties for a list\r\n * origin is optional\r\n * url is site relative url\r\n * pass listTitle or listGUID not both\r\n * @param {{origin:string, url:string, listGUID:string, listTitle:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetListInfo(props) {\r\n\r\n    listUrlConfigure(props);\r\n    return ajaxGetData(props.listUrl);\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * data contained in response is the people info\r\n * origin optional\r\n * url is site relative url optional\r\n * sourceId optional\r\n * query required, ex \"'\" + 'Bureau=\"'+ divisionName + '\"\\''\r\n * @param {{origin:string, url:string, query:string, sourceId:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxPeopleSearch(props) {\r\n\r\n    var allResults = props.currentResults || [],\r\n        serverQueryData = {\r\n            startrow: 0,\r\n            rowlimit: 500,\r\n            TrimDuplicates: false,\r\n            selectproperties: \"'\" + spu.profileProperties.join(',') + \"'\"\r\n        };\r\n\r\n    serverQueryData.startrow = props.startrow ? props.startrow : 0;\r\n    serverQueryData.sourceid = props.sourceId ? props.sourceId : 'b09a7990-05ea-4af9-81ef-edfab16c4e31';\r\n\r\n    //setup search url\r\n    if(!props.url) {\r\n        //default search site\r\n        props.url = '/search';\r\n    }\r\n\r\n    props.endPoint = \"_api/search/query\";\r\n    serverQueryData.querytext = props.query;\r\n\r\n    checkUrlOrigin(props);\r\n\r\n    return $.ajax({\r\n        url: props.configuredUrl,\r\n        type: 'GET',\r\n        headers: {'Accept': 'application/json; odata=minimalmetadata'},\r\n        data: serverQueryData\r\n    }).then(function(empData) {\r\n\r\n        var relevantResults = empData.PrimaryQueryResult.RelevantResults;\r\n\r\n        allResults = allResults.concat(relevantResults.Table.Rows);\r\n        props.currentResults = allResults;\r\n\r\n        if (relevantResults.TotalRows > (serverQueryData.startrow + relevantResults.RowCount)) {\r\n            props.startrow = serverQueryData.startrow + relevantResults.RowCount;\r\n            return ajaxPeopleSearch(props);\r\n        } else {\r\n            return props.currentResults;\r\n        }\r\n    });\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * data contained in response is the users info\r\n * origin is optional\r\n * url is site relative url\r\n * email is the email address of the user\r\n * @param {{origin:string, url:string, email:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxEnsureUser(props) {\r\n    \r\n    return ajaxGetContext(props)\r\n    .then((response) => {\r\n    \r\n        props.endPoint = \"_api/web\";\r\n        checkUrlOrigin(props);\r\n        props.configuredUrl += `/ensureUser('${spu.encodeAccountName(props.email)}')`;\r\n\r\n        return $.ajax({       \r\n            url: props.configuredUrl,   \r\n            type: \"POST\",  \r\n            contentType: ajaxJsonContentType,\r\n            headers: { \r\n                \"Accept\": minimalMeta,\r\n                \"X-RequestDigest\": response.FormDigestValue\r\n            }\r\n        });\r\n    });\r\n\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * data contained in response is the users info\r\n * origin is optional\r\n * url is site relative url\r\n * email is the email address of the user\r\n * @param {{origin:string, url:string, email:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetSiteUserInfoByEmail(props) {\r\n\r\n    props.endPoint = \"_api/web/siteusers\";\r\n    checkUrlOrigin(props);\r\n\r\n    props.configuredUrl += `?$filter=LoginName eq '${spu.encodeAccountName(props.email)}'`;\r\n\r\n    return ajaxGetData(props.configuredUrl);\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * get results from a caml query\r\n * origin is optional\r\n * url is site relative url\r\n * caml is the query\r\n * pass eiter list giud or list title, not both\r\n * @param {{origin:string, url:string, query:string, listGUID:string, listTitle:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetItemsByCaml(props) {\r\n\r\n    return ajaxGetContext(props)\r\n    .then((response) => {\r\n\r\n        let query = { \"query\" :\r\n            {\"__metadata\": \r\n            { \"type\": \"SP.CamlQuery\" },\r\n                \"ViewXml\": props.caml\r\n            }\r\n        },\r\n        headerdata = {\r\n            'Accept': 'application/json; odata=minimalmetadata',\r\n            'Content-Type': 'application/json; odata=verbose',\r\n            'X-RequestDigest': response.FormDigestValue\r\n        };\r\n\r\n        listUrlConfigure(props);\r\n        props.listUrl += '/getitems';\r\n\r\n        return $.ajax({\r\n            url: props.configuredUrl,\r\n            type: 'POST',\r\n            data: JSON.stringify(query),\r\n            headers: headerdata\r\n        });\r\n    });\r\n\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * get a users permissions to site\r\n * the resolve is an array of permission for the user\r\n * origin is optional\r\n * url is site relative url\r\n * @param {{origin:string, url:string, email:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetUserSitePermissions(props) {\r\n\r\n    let encodedEmail = spu.encodeAccountName(props.email);\r\n\r\n    props.endPoint = \"_api/web\";\r\n    checkUrlOrigin(props);\r\n\r\n    props.permLink = `${props.configuredUrl}/getusereffectivepermissions(@user)?@user='${encodedEmail}'`;\r\n    return ajaxGetUserPermissions(props);\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * get a users permissions to list\r\n * the resolve is an array of permission for the user\r\n * origin is optional\r\n * url is site relative url\r\n * caml is the query\r\n * pass eiter list giud or list title, not both\r\n * @param {{origin:string, url:string, email:string, listGUID:string, listTitle:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetUserListPermissions(props) {\r\n\r\n    let encodedEmail = spu.encodeAccountName(props.email);\r\n\r\n    listUrlConfigure(props);\r\n\r\n    props.permLink = `${props.listUrl}/getusereffectivepermissions(@user)?@user='${encodedEmail}'`;\r\n    return ajaxGetUserPermissions(props);\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * get the SP groups that a user is apart of\r\n * the resolve is an array of group names\r\n * origin is optional\r\n * url is site relative url\r\n * userId is the id of user in the site\r\n * @param {{origin:string, url:string, userId:number}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxGetCurrentUserGroups(props) {\r\n\r\n    props.endPoint = \"/_api/web\";\r\n    checkUrlOrigin(props);\r\n\r\n    props.configuredUrl += `/GetUserbyId(${props.userId})/Groups`;\r\n\r\n    return ajaxGetData(props.configuredUrl)\r\n    .then(function(groups){\r\n\r\n        var groupArray = [];\r\n\r\n        groups.value.forEach(function(item) {\r\n            groupArray.push(item.Title);\r\n        });\r\n\r\n        return groupArray;\r\n\r\n    });\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * creates an item in the list that is passed\r\n * the resolve is an object with the created item info\r\n * origin is optional\r\n * url is site relative url\r\n * listName is optional\r\n * pass either listTitle or listGUID not both\r\n * infoToServer should be a object whos key is the column name and the value is what you want stored in that column\r\n * @param {{origin:string, url:string, listName:string, listTitle:string, listGUID:string, infoToServer:object}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxCreateItem(props) {\r\n    return nonDeleteProcess(props);\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * updates an item in the list that is passed\r\n * the resolve is an object with the update item info\r\n * origin is optional\r\n * url is site relative url\r\n * listName is optional\r\n * pass either listTitle or listGUID not both\r\n * itemId is the id number of the item to be updated\r\n * infoToServer should be a object whos key is the column name and the value is what you want stored in that column\r\n * @param {{origin:string, url:string, listName:string, listTitle:string, listGUID:string, itemId:number, infoToServer:object}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxUpdateItem(props) {\r\n    // listTitle or listGUID\r\n    // {\r\n    //  origin: ,\r\n    // \tlistName: 'routeState', optional\r\n    // \tlistTitle: 'Route State'\r\n    // \turl: \"/sites/EA/routing\",\r\n    // \titemId: 3,\r\n    // \tinfoToServer: {\r\n    //    Title: 'Route '+ routeId +' progress tracker',\r\n    //    TaskStatus: 'Draft',\r\n    //    parentRouteID: routeId\r\n    // }\r\n\r\n    props.headerData = {\r\n        \"X-HTTP-Method\": \"MERGE\",\r\n        \"If-Match\": props.etag || \"*\"\r\n    };\r\n    return nonDeleteProcess(props);\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * deletes an item in the list that is passed\r\n * origin is optional\r\n * url is site relative url\r\n * pass either listTitle or listGUID not both\r\n * itemId is the id number of the item to be deleted\r\n * etag is optional\r\n * be warned if you use this function, the item you delete will be gone and unrecoverable!!!!\r\n * @param {{origin:string, url:string, listTitle:string, listGUID:string, itemId:number, etag:string}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxDeleteItem(props) {\r\n    //todo try to complete this function without an etag\r\n    props.headerData = {\r\n        'X-HTTP-Method' : 'DELETE',\r\n        \"If-Match\": props.etag || \"*\"\r\n    };\r\n    return deleteProcess(props);\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * recycles an item in the list that is passed\r\n * origin is optional\r\n * url is site relative url\r\n * pass either listTitle or listGUID not both\r\n * itemId is the id number of the item to be recycled\r\n * @param {{origin:string, url:string, listTitle:string, listGUID:string, itemId:number}} props\r\n * @returns {promise}\r\n */\r\nexport function ajaxRecycleItem(props) {\r\n\r\n    props.urlModifier = \"/recycle\";\r\n    return deleteProcess(props);\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * retrieves profile properties for the user email passed\r\n * if you do not pass a user email it retrieves the current user\r\n * origin is optional\r\n * email is optional\r\n * @param {{origin:string, email:string}} props\r\n * @returns {promise}\r\n */\r\nexport function userProfileData(props) {\r\n\r\n    let addon = null;\r\n\r\n    checkUrlOrigin(props);\r\n\r\n    if(props.email) {\r\n        props.endPoint = '_api/sp.userprofiles.peoplemanager';\r\n        addon = `/getpropertiesfor(@v)?@v='${spu.encodeAccountName(props.email)}'&`;\r\n    } else {\r\n        //url for get current user\r\n        props.endPoint = '_api/SP.UserProfiles.PeopleManager/GetMyProperties';\r\n        addon = '?';\r\n    }\r\n    props.configuredUrl += `${addon}$select=UserProfileProperties`;\r\n    \r\n    return ajaxGetData(props.configuredUrl)\r\n    .then(function(userData){ //success\r\n        if (userData['odata.null'] === true) {\r\n            return [];\r\n        } else{\r\n            return userData.UserProfileProperties;\r\n        }\r\n    });\r\n}\r\n/**\r\n * Returns a jquery promise\r\n * retrieves the columns of the passed list\r\n * origin is optional\r\n * url is a site relative url\r\n * pass listGUID or listTitle not both\r\n * allData is optional, it will include all hidden and readonly if you pass true\r\n * @param {{origin:string, url:string, listGUID:string, listTitle:string, allData:boolean}} props\r\n * @returns {promise}\r\n */\r\nexport function getListColumns(props) {\r\n\r\n    if(!props.allData) {\r\n        props.allData = false;\r\n    }\r\n    listUrlConfigure(props);\r\n    props.listUrl += `/fields?$filter=Hidden eq ${props.allData} and ReadOnlyField eq ${props.allData}`;\r\n\r\n\treturn ajaxGetData(props.listUrl);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/library.js"],"sourceRoot":""}